# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢: Twin Tasters (–ë–ª–∏–∑–Ω–µ—Ü—ã –≤–∫—É—Å–∞)

## –ó–∞ 30 —Å–µ–∫—É–Ω–¥

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/profile/taste-map` –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "–í–∞—à–∏ –±–ª–∏–∑–Ω–µ—Ü—ã –≤–∫—É—Å–∞" - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–º–æ—Ç—Ä—è—Ç —Ñ–∏–ª—å–º—ã —Å –≤–∞—à–∏–º–∏ –∂–µ –≤–∫—É—Å–∞–º–∏.

```
–ö–∏–Ω–æ–º–∞–Ω–∞ AB12 ‚Ä¢ 42 —Ñ–∏–ª—å–º–∞ ‚Ä¢ 6 –º–µ—Å –Ω–∞–∑–∞–¥    [85.2% match]
–ö–∏–Ω–æ–º–∞–Ω–∞ CD34 ‚Ä¢ 127 —Ñ–∏–ª—å–º–æ–≤ ‚Ä¢ 1 –≥–æ–¥ –Ω–∞–∑–∞–¥  [72.1% match]
```

---

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### üì¶ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
1. **`src/app/api/user/similar-users/route.ts`** - API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **`src/app/profile/taste-map/TwinTasters.tsx`** - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

### ‚úèÔ∏è –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
1. **`src/app/profile/taste-map/TasteMapClient.tsx`** - –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç TwinTasters
2. **`src/lib/taste-map/similarity.ts`** - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ—Ü–µ–Ω–æ–∫ (–±—ã–ª–∞ 0, —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç)

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/features/twin-tasters.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/features/twin-tasters-testing.md` - –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- `docs/features/twin-tasters-analysis.md` - –ê–Ω–∞–ª–∏–∑ —á—Ç–æ –±—ã–ª–æ/—á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ (Server)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/profile/taste-map` –≥—Ä—É–∑–∏—Ç TasteMap —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–∞–≥ 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (Server ‚Üí Client)
- TasteMapClient —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `<TwinTasters userId={userId} />`

### –®–∞–≥ 3: –ó–∞–ø—Ä–æ—Å (Client)
- TwinTasters –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å: `GET /api/user/similar-users?limit=15`

### –®–∞–≥ 4: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ (API)
```
API –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
  ‚Üì
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç Redis –∫—ç—à
  ‚îú‚îÄ –ù–ê–ô–î–ò ‚Üí –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–±—ã—Å—Ç—Ä–æ)
  ‚îî‚îÄ –ù–ï –ù–ê–ô–î–ò:
      ‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å 100 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
      ‚îú‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã—á–∏—Å–ª–∏—Ç—å:
      ‚îÇ  ‚Ä¢ –ñ–∞–Ω–∫–æ–≤–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (cosine)
      ‚îÇ  ‚Ä¢ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—é –æ—Ü–µ–Ω–æ–∫ (pearson)
      ‚îÇ  ‚Ä¢ –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –∞–∫—Ç–µ—Ä–æ–≤ (jaccard)
      ‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Redis –Ω–∞ 24 —á–∞—Å–∞
      ‚îî‚îÄ –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  ‚Üì
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

### –®–∞–≥ 5: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (Client)
- TwinTasters –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º —Å—Ö–æ–¥—Å—Ç–≤–∞

---

## –¢—Ä–∏ –º–µ—Ç—Ä–∏–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ß—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç | –í–µ—Å | –§–æ—Ä–º—É–ª–∞ |
|---------|---|---|---|
| **Taste** | –ñ–∞–Ω—Ä—ã | 50% | Cosine similarity |
| **Ratings** | –û—Ü–µ–Ω–∫–∏ –æ–±—â–∏—Ö —Ñ–∏–ª—å–º–æ–≤ | 30% | Pearson correlation ‚Üê –ù–û–í–û–ï |
| **Persons** | –ê–∫—Ç–µ—Ä—ã + —Ä–µ–∂–∏—Å—Å–µ—Ä—ã | 20% | Jaccard similarity |

**–†–∞–Ω—å—à–µ:** Ratings –≤—Å–µ–≥–¥–∞ –±—ã–ª–∞ 0 ‚ùå  
**–¢–µ–ø–µ—Ä—å:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏–∑ –≤–∞—à–∏—Ö –æ—Ü–µ–Ω–æ–∫ –æ–±—â–∏—Ö —Ñ–∏–ª—å–º–æ–≤ ‚úÖ

---

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä—è–º–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
```
–í—ã:     –∂–∞–Ω—Ä—ã=[–ö–æ–º–µ–¥–∏—è:80, –î—Ä–∞–º–∞:60], –∞–∫—Ç–µ—Ä—ã=[–¢–æ–º –•–∞–Ω–∫—Å]
–û–Ω–∏:    –∂–∞–Ω—Ä—ã=[–ö–æ–º–µ–¥–∏—è:75, –î—Ä–∞–º–∞:65], –∞–∫—Ç–µ—Ä—ã=[–¢–æ–º –•–∞–Ω–∫—Å]
Result: 85% match ‚úÖ
```

### –ü—Ä–∏–º–µ—Ä 2: –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ –≤–∫—É—Å—ã
```
–í—ã:     –∂–∞–Ω—Ä—ã=[–ö–æ–º–µ–¥–∏—è:90], –æ—Ü–µ–Ω–∫–∏ –≤—Å–µ–º 9-10
–û–Ω–∏:    –∂–∞–Ω—Ä—ã=[–¢—Ä–∏–ª–ª–µ—Ä:90], –æ—Ü–µ–Ω–∫–∏ —Ç–æ–ª—å–∫–æ –∫–æ–º–µ–¥–∏—è–º 2-3
Result: 15% match ‚ùå
```

### –ü—Ä–∏–º–µ—Ä 3: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö
```
–í—ã:     3 —Ñ–∏–ª—å–º–∞ (< 5)
Result: Twin Tasters –Ω–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω (–Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 5)
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1Ô∏è‚É£ –ó–∞–ø—É—Å–∫
```bash
npm run dev
# –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://localhost:3000
```

### 2Ô∏è‚É£ –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
```
http://localhost:3000/profile/taste-map
```

### 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
- –ï—Å–ª–∏ ‚â• 5 —Ñ–∏–ª—å–º–æ–≤ –≤ —Å–ø–∏—Å–∫–µ ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª —Å –±–ª–∏–∑–Ω–µ—Ü–∞–º–∏
- –ï—Å–ª–∏ < 5 —Ñ–∏–ª—å–º–æ–≤ ‚Üí —Ä–∞–∑–¥–µ–ª —Å–∫—Ä—ã—Ç

### 4Ô∏è‚É£ –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å API
```bash
curl "http://localhost:3000/api/user/similar-users?limit=10"
```

–û—Ç–≤–µ—Ç:
```json
{
  "similarUsers": [
    {
      "userId": "abc123def456",
      "overallMatch": 78.5,
      "watchCount": 42,
      "memberSince": "2025-06-15T10:30:00Z"
    }
  ],
  "cached": false,
  "computedAt": "2026-02-24T15:35:00Z"
}
```

---

## –§–∞–π–ª—ã –Ω–∞ github

–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```typescript
// –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /profile/taste-map –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
<TwinTasters userId={userId} />

// –ò–ª–∏ –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API
const response = await fetch('/api/user/similar-users?limit=15');
const { similarUsers } = await response.json();

// –ö–∞–∂–¥—ã–π close –ø–æ—Ö–æ–∂–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
// {
//   userId: string,
//   overallMatch: number (0-100),
//   watchCount: number,
//   memberSince: Date
// }
```

---

## –ö-–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–ª–µ–π

- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
  - –£ –≤–∞—Å ‚â• 5 —Ñ–∏–ª—å–º–æ–≤ (–∏–Ω–∞—á–µ –ø—Ä–æ—Ñ–∏–ª—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω)
  - –í —Å–∏—Å—Ç–µ–º–µ –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∫–∞–Ω–¥–∏–¥–∞—Ç—ã)
  
- **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è 100 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)
  - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å match > 70%
  - –°–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ % —Å—Ö–æ–¥—Å—Ç–≤–∞ (—É–±—ã–≤–∞—é—â–∏–π)

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è |
|----------|-------|
| –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å | ~500ms (–≤—ã—á–∏—Å–ª–µ–Ω–∏—è) |
| –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å | ~50ms (–∏–∑ Redis) |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ | **24 —á–∞—Å–∞** |

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
1. **–í–æ–ª–∏–∞—Ü–∏—è "—Å–ª–µ–¥–∏—Ç—å" –∑–∞ –±–ª–∏–∑–Ω–µ—Ü–æ–º** - –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –µ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
2. **–ß–∞—Ç –º–µ–∂–¥—É –±–ª–∏–∑–Ω–µ—Ü–∞–º–∏** - –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Ñ–∏–ª—å–º–æ–≤
3. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç –±–ª–∏–∑–Ω–µ—Ü–æ–≤** - "—á—Ç–æ —Å–º–æ—Ç—Ä–∏—Ç –º–æ–π –±–ª–∏–∑–Ω–µ—Ü"
4. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - "–Ω–∞–π–¥–µ–Ω–æ 5 –±–ª–∏–∑–Ω–µ—Ü–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü"
5. **–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç–∏** - "–Ω–∞–π—Ç–∏ –ª—é–¥–µ–π —Å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–º –≤–∫—É—Å–æ–º"

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã?

–í—Å–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (DevTools F12) –∏–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª npm:

```javascript
// Browser console test
fetch('/api/user/similar-users')
  .then(r => r.json())
  .then(d => console.log(d))
```

‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**
