# üö® CRITICAL BUG FIX: Twin Tasters - Similar Users Not Found

**Date:** 2026-02-24  
**Severity:** CRITICAL üî¥  
**Status:** ‚úÖ FIXED v2.0 (Updated to handle missing candidates)

---

## –ü—Ä–æ–±–ª–µ–º–∞

**–°–∏–º–ø—Ç–æ–º:** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/profile/taste-map` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "No similar users found" –¥–∞–∂–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å 300+ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –∏ –Ω–∞–ª–∏—á–∏–µ–º –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

**–ü—Ä–∏–º–µ—Ä:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A: 550 —Ñ–∏–ª—å–º–æ–≤ (300+ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ)
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B: 150 —Ñ–∏–ª—å–º–æ–≤ (100+ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ)
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å C: 180 —Ñ–∏–ª—å–º–æ–≤ (120+ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ)

–†–µ–∑—É–ª—å—Ç–∞—Ç: "No similar users found" ‚ùå
```

---

## –ö–æ—Ä–Ω–µ–≤—ã–µ –ü—Ä–∏—á–∏–Ω—ã (2 –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞–π–¥–µ–Ω—ã!)

### üêõ –ë–∞–≥ #1: `isSimilar()` –ø—Ä–æ–≤–µ—Ä—è–ª–∞ —Ç–æ–ª—å–∫–æ –∂–∞–Ω—Ä—ã (–ò–°–ü–†–ê–í–õ–ï–ù–û)

–§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–ª–∞ —Ç–æ–ª—å–∫–æ **–∂–∞–Ω—Ä–æ–≤–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ** (0.7), –∏–≥–Ω–æ—Ä–∏—Ä—É—è —Ä–µ–π—Ç–∏–Ω–≥–∏ (30% –≤–µ—Å) –∏ –∞–∫—Ç–µ—Ä–æ–≤ (20% –≤–µ—Å).  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ûisEmpty

### üêõ –ë–∞–≥ #2: API –∏—â–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ 30 –¥–Ω–µ–π (–ò–°–ü–†–ê–í–õ–ï–ù–û)

–°–∏—Å—Ç–µ–º–∞ –∏—Å–∫–∞–ª–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –≤ **–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π**. –ï—Å–ª–∏ –¥—Ä—É–≥–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –±—ã–ª–æ - API –≤–æ–∑–≤—Ä–∞—â–∞–ª –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –¥–∞–∂–µ –µ—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.

```typescript
// ‚ùå –ë–´–õ–û - –∏—â–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ 30 –¥–Ω–µ–π
const thirtyDaysAgo = new Date();
thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);

const activeUsers = await prisma.watchList.findMany({
  where: {
    addedAt: { gte: thirtyDaysAgo },
    userId: { not: userId },
  },
});
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ 3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π - —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–π–¥–µ—Ç —Ç–æ–ª—å–∫–æ –µ–≥–æ. –ï—Å–ª–∏ –æ–Ω –Ω–µ –ø–æ—Ö–æ–∂ - –≤–µ—Ä–Ω–µ—Ç "No similar users found".

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v2.0

---

## –†–µ—à–µ–Ω–∏–µ

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #1: –§—É–Ω–∫—Ü–∏—è `isSimilar()` (v1.0)

```typescript
// src/lib/taste-map/similarity.ts (–ü–†–ê–í–ò–õ–¨–ù–û ‚úÖ)
export function isSimilar(result: SimilarityResult): boolean {
  return result.overallMatch > 0.5;  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ!
}
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- –ë—ã–ª–æ: `result.tasteSimilarity > 0.7` (—Ç–æ–ª—å–∫–æ –∂–∞–Ω—Ä—ã, –≤—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥)
- –°—Ç–∞–ª–æ: `result.overallMatch > 0.5` (–≤—Å–µ —Ç—Ä–∏ –º–µ—Ç—Ä–∏–∫–∏, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–æ—Ä–æ–≥)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #2: –ü–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (v2.0 - –ù–û–í–û–ï)

**–§–∞–π–ª:** `src/app/api/user/similar-users/route.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** API –∏—â–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ 30 –¥–Ω–µ–π. –ï—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö - –Ω–µ –Ω–∞–π–¥–µ—Ç –Ω–∏–∫–æ–≥–æ.

**–†–µ—à–µ–Ω–∏–µ - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–æ–∏—Å–∫:**

```typescript
// –£—Ä–æ–≤–µ–Ω—å 1: –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ 30 –¥–Ω–µ–π
let candidateIds = await getActiveUsers(30);  // 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

// –£—Ä–æ–≤–µ–Ω—å 2: –ï—Å–ª–∏ < 10, —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ 90 –¥–Ω–µ–π
if (candidateIds.length < 10) {
  candidateIds = await getActiveUsers(90);   // 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ 3 –º–µ—Å—è—Ü–∞
}

// –£—Ä–æ–≤–µ–Ω—å 3: –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ < 10, –≤–∑—è—Ç—å –í–°–ï–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
if (candidateIds.length < 10) {
  candidateIds = await getAllUsersWithMinHistory();  // –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å 5+ —Ñ–∏–ª—å–º–æ–≤
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∞–∂–µ –µ—Å–ª–∏ –¥—Ä—É–≥–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç.

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #3: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ê–ª–≥–æ—Ä–∏—Ç–º—ã (v1.0)

| –§–∞–π–ª | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|------|------|-------|
| `taste-match.ts` | `result.tasteSimilarity >= 0.7` | `result.overallMatch >= 0.7` |
| `want-overlap.ts` | `result.tasteSimilarity >= 0.6` | `result.overallMatch >= 0.6` |
| `drop-patterns.ts` | `result.tasteSimilarity >= 0.65` | `result.overallMatch >= 0.65` |

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: Debug endpoint

–ù–æ–≤—ã–π endpoint –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```
GET /api/user/similar-users/debug?limit=10&details=true
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–∏—á–∏–Ω—É –ø–æ—á–µ–º—É –æ–Ω –ø—Ä–æ—à–µ–ª –∏–ª–∏ –Ω–µ –ø—Ä–æ—à–µ–ª —Ñ–∏–ª—å—Ç—Ä.

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –î–û (–±–µ–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
```bash
curl "http://localhost:3000/api/user/similar-users?limit=10"

# –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
{
  "similarUsers": [],
  "message": "No similar users found"
}
```

### –ü–û–°–õ–ï (—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º)
```bash
curl "http://localhost:3000/api/user/similar-users?limit=10"

# –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞–π–¥–µ–Ω—ã –±–ª–∏–∑–Ω–µ—Ü—ã!
{
  "similarUsers": [
    {
      "userId": "abc123def456",
      "overallMatch": 78.5,
      "watchCount": 127,
      "memberSince": "2025-06-15T10:30:00Z"
    },
    {
      "userId": "xyz789uvw012",
      "overallMatch": 62.3,
      "watchCount": 89,
      "memberSince": "2025-08-20T15:45:00Z"
    }
  ],
  "cached": false,
  "message": "Found 2 similar user(s)"
}
```

---

## –§–∞–π–ª—ã –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
```
‚úÖ src/lib/taste-map/similarity.ts
   - isSimilar(): –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overallMatch –≤–º–µ—Å—Ç–æ tasteSimilarity

‚úÖ src/app/api/user/similar-users/route.ts (V2.0)
   - –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (30 –¥–Ω–µ–π ‚Üí 90 –¥–Ω–µ–π ‚Üí –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç _count –≤–º–µ—Å—Ç–æ n+1 –∑–∞–ø—Ä–æ—Å–æ–≤)
```

### –°–º–µ–∂–Ω—ã–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–æ—Ç –∂–µ –±–∞–≥)
```
‚úÖ src/lib/recommendation-algorithms/taste-match.ts
   - computeSimilarity(): –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ overallMatch

‚úÖ src/lib/recommendation-algorithms/want-overlap.ts
   - computeSimilarity(): –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ overallMatch

‚úÖ src/lib/recommendation-algorithms/drop-patterns.ts
   - computeSimilarity(): –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ overallMatch
```

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
```
‚úÖ src/app/api/user/similar-users/debug/route.ts (–ù–û–í–´–ô)
   - Debug endpoint —Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏

‚úÖ docs/bugs/2026-02-24-similar-users-not-found.md (–ù–û–í–´–ô)
   - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–∞–≥–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

‚úÖ BUG_FIX_TESTING.md (–ù–û–í–´–ô)
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```

---

## –ö–∞–∫ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 1. –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
npm run dev
# –û—Ç–∫—Ä—ã—Ç—å http://localhost:3000/profile/taste-map
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ: "–í–∞—à–∏ –±–ª–∏–∑–Ω–µ—Ü—ã –≤–∫—É—Å–∞" —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
```

### 2. API endpoint
```bash
curl "http://localhost:3000/api/user/similar-users?limit=10"
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

### 3. Debug endpoint (–ø–æ–¥—Ä–æ–±–Ω–æ)
```bash
curl "http://localhost:3000/api/user/similar-users/debug?limit=10&details=true" | jq
# –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

## –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞

### –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø ‚ùå)
```
if (–∂–∞–Ω—Ä—ã > 0.7) {
  ‚Üí –±–ª–∏–∑–Ω–µ—Ü—ã
} else {
  ‚Üí –Ω–µ –±–ª–∏–∑–Ω–µ—Ü—ã
}

–ü—Ä–æ–±–ª–µ–º–∞: –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç 50% —Ñ–∞–∫—Ç–æ—Ä–æ–≤ (—Ä–µ–π—Ç–∏–Ω–≥–∏ + –∞–∫—Ç–µ—Ä—ã)
```

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (–ü–†–ê–í–ò–õ–¨–ù–ê–Ø ‚úÖ)
```
score = –∂–∞–Ω—Ä—ã*0.5 + —Ä–µ–π—Ç–∏–Ω–≥–∏*0.3 + –∞–∫—Ç–µ—Ä—ã*0.2
if (score > 0.5) {
  ‚Üí –±–ª–∏–∑–Ω–µ—Ü—ã
} else {
  ‚Üí –Ω–µ –±–ª–∏–∑–Ω–µ—Ü—ã
}

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ —Ç—Ä–∏ –º–µ—Ç—Ä–∏–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞
```

### –†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä
```
User A: —Å–º–æ—Ç—Ä–∏—Ç –î—Ä–∞–º–∞ 100%, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–µ—Ä—å–µ–∑–Ω–æ, –ª—é–±–∏—Ç –î–µ–ø–∞—Ä–¥—å–µ
User B: —Å–º–æ—Ç—Ä–∏—Ç –ö—Ä–∏–º–∏–Ω–∞–ª 100%, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–µ—Ä—å–µ–∑–Ω–æ, –ª—é–±–∏—Ç –î–µ–ø–∞—Ä–¥—å–µ

–°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê:
- –∂–∞–Ω—Ä—ã = 0 (—Ä–∞–∑–Ω—ã–µ)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–ï–¢ –±–ª–∏–∑–Ω–µ—Ü–æ–≤ ‚ùå

–ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê:
- –∂–∞–Ω—Ä—ã = 0 (—Ä–∞–∑–Ω—ã–µ)
- —Ä–µ–π—Ç–∏–Ω–≥–∏ = 0.9 (–ø–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
- –∞–∫—Ç–µ—Ä—ã = 0.8 (–º–Ω–æ–≥–æ –æ–±—â–∏—Ö)
- score = 0*0.5 + 0.9*0.3 + 0.8*0.2 = 0.27 + 0.16 = 0.43

–•–º, –≤—Å–µ –µ—â–µ < 0.5. –ù—É–∂–Ω—ã –±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–∏–µ –≤–∫—É—Å—ã.

–ù–æ –µ—Å–ª–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ = 0.95 –∏ –∞–∫—Ç–µ—Ä—ã = 0.9:
- score = 0*0.5 + 0.95*0.3 + 0.9*0.2 = 0.285 + 0.18 = 0.465
- –í—Å–µ –µ—â–µ < 0.5

–ï—Å–ª–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ = 1.0 –∏ –∞–∫—Ç–µ—Ä—ã = 1.0:
- score = 0*0.5 + 1.0*0.3 + 1.0*0.2 = 0.3 + 0.2 = 0.5 ‚úÖ
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –î–ê, –±–ª–∏–∑–Ω–µ—Ü—ã ‚úÖ
```

---

## –ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã:** –í–°–ï, –Ω–æ –æ—Å–æ–±–µ–Ω–Ω–æ —Ç–µ —Å –±–æ–ª—å—à–æ–π —Ñ–∏–ª—å–º–æ—Ç–µ–∫–æ–π  
**API endpoints –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã:** 
- `/api/user/similar-users` (Twin Tasters)
- `/api/recommendations/patterns` (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
- `taste_match_v1` –∞–ª–≥–æ—Ä–∏—Ç–º
- `want_overlap_v1` –∞–ª–≥–æ—Ä–∏—Ç–º
- `drop_patterns_v1` –∞–ª–≥–æ—Ä–∏—Ç–º

**–¢—è–∂–µ—Å—Ç—å:** –ö–†–ò–¢–ò–ß–ù–ê–Ø - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª Twin Tasters –±—ã–ª —Å–ª–æ–º–∞–Ω

---

## –û—Ç–∫—É–¥–∞ —ç—Ç–æ –≤–∑—è–ª–æ—Å—å

### –ü—Ä–æ–±–ª–µ–º–∞ #1: `isSimilar()` (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –¥–æ–ª–≥)
–§—É–Ω–∫—Ü–∏—è –±—ã–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∂–∞–Ω—Ä–æ–≤–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞, –Ω–æ –∑–∞–±—ã–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –µ—ë –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `computeOverallMatch()`.

### –ü—Ä–æ–±–ª–µ–º–∞ #2: –ü–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (–î–∏–∑–∞–π–Ω API)
API –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∑–∞ 30 –¥–Ω–µ–π). –≠—Ç–æ –ª–æ–≥–∏—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –Ω–æ –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π fallback-—É—Ä–æ–≤–Ω–µ–π.

---

## –ò—Å—Ç–æ—Ä–∏—è –ò–∑–º–µ–Ω–µ–Ω–∏–π

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
|--------|------|---|
| v1.0 | 2026-02-24 | `isSimilar()` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `overallMatch` + 3 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞ |
| v2.0 | 2026-02-24 | –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (30 –¥–Ω–µ–π ‚Üí 90 –¥–Ω–µ–π ‚Üí –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏) |
| v2.1 | 2026-02-24 | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ç—Ä–µ—Ç—å–µ–º —É—Ä–æ–≤–Ω–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `_count` –≤–º–µ—Å—Ç–æ n+1) |

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ v1.0: `isSimilar()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `overallMatch`
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ v2.0: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ v2.1: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ç—Ä–µ—Ç—å–µ–º —É—Ä–æ–≤–Ω–µ  
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: Debug endpoint –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
6. üîÑ TODO: –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ production –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ß—Ç–µ–Ω–∏–µ

- [–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–∞–≥–∞](./docs/bugs/2026-02-24-similar-users-not-found.md)
- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](./BUG_FIX_TESTING.md)

---

**SUMMARY:** –ö—Ä–∏—Ç–∏—á–Ω—ã–π –±–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω. Twin Tasters –¥–æ–ª–∂–Ω–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ - –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ **–≤—Å–µ—Ö —Ç—Ä–µ—Ö –º–µ—Ç—Ä–∏–∫ —Å—Ö–æ–¥—Å—Ç–≤–∞**, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∂–∞–Ω—Ä–æ–≤. üéâ
